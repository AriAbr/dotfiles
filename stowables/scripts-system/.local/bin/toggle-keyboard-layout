#!/usr/bin/env bash

layout_options=($(gsettings get org.gnome.desktop.input-sources sources | awk -F"[,()']" '{for(i=2; i<NF; i+=2) print $i}'))
selected_value=$(printf "%s\n" "${layout_options[@]}" | rofi -l 4 -dmenu -p "Select keyboard layout:")
selected_index=$(printf "%s\n" "${layout_options[@]}" | awk -v val="$selected_value" '{if ($0 == val) print NR-1}')

gsettings set org.gnome.desktop.input-sources current $selected_index
